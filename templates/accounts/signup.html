{% extends base_template %}
{% load widget_tweaks %}

{% block join_form %}

<div class="modal-container z-50 bg-base-300/50">
    <div class="bg-base-200 shadow-2xl p-[20px] rounded-xl m-auto w-[300px]">

        <a href="/" hx-boost="true" class="btn btn-sm btn-circle btn-outline float-end">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
        </a>
        <h3 class="text-3xl pb-3">Sign Up</h3>
        <form action="{% url "signup" %}" method="post" class="flex flex-col gap-4">
            {% csrf_token %}
            <div class="">
                <div id="username-error"></div>
                <div id="password-error"></div>
            </div>
            <label class="input input-bordered flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4 opacity-70"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6ZM12.735 14c.618 0 1.093-.561.872-1.139a6.002 6.002 0 0 0-11.215 0c-.22.578.254 1.139.872 1.139h9.47Z" /></svg>
                {% render_field form.username placeholder="Username" class="grow" hx-post="/check-username/" hx-swap="innerhtml" hx-trigger="keyup change delay:1s" hx-target="#username-error" %}
            </label>
            <label class="input input-bordered flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
                </svg>
                {% render_field form.display_name placeholder="Display name" class="grow" %}
            </label>
            <label class="input input-bordered flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4 opacity-70"><path fill-rule="evenodd" d="M14 6a4 4 0 0 1-4.899 3.899l-1.955 1.955a.5.5 0 0 1-.353.146H5v1.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-2.293a.5.5 0 0 1 .146-.353l3.955-3.955A4 4 0 1 1 14 6Zm-4-2a.75.75 0 0 0 0 1.5.5.5 0 0 1 .5.5.75.75 0 0 0 1.5 0 2 2 0 0 0-2-2Z" clip-rule="evenodd" /></svg>
                {% render_field form.password1 placeholder="Password" class="grow" hx-post="/check-password/" hx-swap="innerhtml" hx-trigger="keyup change delay:1s" hx-target="#password-error" %}
            </label>
            <label class="input input-bordered flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="w-4 h-4 opacity-70"><path fill-rule="evenodd" d="M14 6a4 4 0 0 1-4.899 3.899l-1.955 1.955a.5.5 0 0 1-.353.146H5v1.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-2.293a.5.5 0 0 1 .146-.353l3.955-3.955A4 4 0 1 1 14 6Zm-4-2a.75.75 0 0 0 0 1.5.5.5 0 0 1 .5.5.75.75 0 0 0 1.5 0 2 2 0 0 0-2-2Z" clip-rule="evenodd" /></svg>
                {% render_field form.password2 placeholder="Confirm password" class="grow" hx-post="/check-password/" hx-swap="innerhtml" hx-trigger="keyup change delay:1s" hx-target="#password-error" %}
            </label>
            <input type="submit" value="Sign Up" class="btn btn-sm btn-accent rounded-full w-min">
        </form>
    </div>
    <div role="alert" class="fixed bottom-6 w-fit" id="signup_alert">
        {% for field in form %}
        {% if field.errors %}
            <ul class="bg-error p-4 text-error-content shadow-2xl rounded-xl">

                <button class="ms-auto float-right" _="on click add .hidden to #signup_alert">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                    </svg>                      
                </button>

                {% for error in field.errors %}
                    <li class="">
                        <span class="">{{ error }}</span>
                    </li>
                {% endfor %}
            </ul>
            {% endif %}
        {% endfor %}
    </div>
</div>

{% endblock join_form %}